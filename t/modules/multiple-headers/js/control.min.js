!function(a){if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){try{var b=require("jquery")}catch(e){}module.exports=a(b)}else if("function"==typeof define&&define.amd)define(["jquery"],function(e){return a(e)});else{var c;try{c=eval("this")}catch(e){c=window}c.deparam=a(c.jQuery)}}(function(e){var t=function(e,s){var d={},u={true:!0,false:!1,null:null};return e&&e.replace(/\+/g," ").split("&").forEach(function(e){var t,i=e.split("="),o=decodeURIComponent(i[0]),n=d,a=0,r=o.split("]["),c=r.length-1;if(/\[/.test(r[0])&&/\]$/.test(r[c])?(r[c]=r[c].replace(/\]$/,""),c=(r=r.shift().split("[").concat(r)).length-1):c=0,2===i.length)if(t=decodeURIComponent(i[1]),s&&(t=t&&!isNaN(t)&&+t+""===t?+t:"undefined"===t?void 0:void 0!==u[t]?u[t]:t),c)for(;a<=c;a++)n=n[o=""===r[a]?n.length:r[a]]=a<c?n[o]||(r[a+1]&&isNaN(r[a+1])?{}:[]):t;else"[object Array]"===Object.prototype.toString.call(d[o])?d[o].push(t):!{}.hasOwnProperty.call(d,o)?d[o]=t:d[o]=[d[o],t];else o&&(d[o]=s?void 0:"")}),d};return e&&(e.prototype.deparam=e.deparam=t),t});var tophive_get_customize_fields=function(e){var t=top.wp.customize.control(e).section(),i=top.wp.customize.section(t).panel(),o={};return _.each(top.wp.customize.panel(i).sections(),function(e){_.each(e.controls(),function(e){o[e.id]=1})}),JSON.stringify(o)};function tophive_customize_ms_change_url(e,t){top._redirect_ms_header_url=e,top._redirect_msid=t,console.log("_redirect_msid",t),OneCoreCustomizer_MS.id=parseInt(OneCoreCustomizer_MS.id),OneCoreCustomizer_MS.id!=t&&top._save_button.trigger("click")}wp.ajax.o_send=wp.ajax.send,wp.ajax.send=function(e,t){return _.isObject(e)?(e.data.msid=OneCoreCustomizer_MS.id,e.data.builder_id=top._current_builder_panel):(t.data.msid=OneCoreCustomizer_MS.id,t.data.builder_id=top._current_builder_panel,t.data.customize_fields=tophive_get_customize_fields("multiple_headers")),console.log("WP.AJAX",e),this.o_send(e,t)},top._redirect_ms_header_url=!1,top._redirect_msid=!1,top._save_button=!1,function(d,u){top._save_button=jQuery("input#save"),u.bind("saved",function(){if(top._redirect_ms_header_url){OneCoreCustomizer_MS.id=parseInt(OneCoreCustomizer_MS.id),jQuery(window).off("beforeunload.customize-confirm");var e=document.createElement("a");e.href=location.href;var t=_.extend(jQuery.deparam(e.search.substr(1)),{autofocus:{control:"multiple_headers"},msid:top._redirect_msid,url:top._redirect_ms_header_url});e.search=d.param(t),console.log("Redirect to irlParser.href",e.href),location.replace(e.href)}}),u.bind("save-request-params",function(e){e.msid=OneCoreCustomizer_MS.id,e.builder_id=top._current_builder_panel,e.customize_fields=tophive_get_customize_fields("multiple_headers")}),d(document).on("tophive_builder_panel_loaded",function(e,t,i){if("header"===t&&(d(".tophive--cb-actions",i.container).prepend('<a data-id="multiple_headers" class="focus-section button button-secondary" href="#">'+OneCoreCustomizer_MS.l10n.multiple_text+"</a>"),0<OneCoreCustomizer_MS.id)){var o=d('<a class="display-condition" href="#">'+OneCoreCustomizer_MS.l10n.display+"</a>");d(".tophive--cb-devices-switcher",i.container).append(o);var n=d('<div class="tophive--device-panel tophive--display-panel tophive--panel-hide"></div>');d(".tophive--cb-body",i.contailner).append(n),n.tophive_condition({save_cb:function(e,t){wp.customize.previewer.previewUrl.set(e.url);var i=_.clone(window.location),o=i.origin+i.pathname+"?autofocus[control]=multiple_headers&msid="+t.msid+"&url="+encodeURIComponent(e.url);window.history.pushState(o,"",o)}}),o.on("click",function(e){e.preventDefault(),d(".tophive--cb-devices-switcher a",i.container).removeClass("tophive--tab-active"),o.addClass("tophive--tab-active"),d(".tophive--device-panel",i.contailner).addClass("tophive--panel-hide"),d(".tophive--display-panel",i.contailner).removeClass("tophive--panel-hide")})}}),u.bind("ready",function(){d(".multiple-section-list").each(function(){var s=d(this),e={action:"tophive/load-sections",builder_id:s.attr("data-builder-id")||"",control_id:s.attr("data-control-id")||"",msid:OneCoreCustomizer_MS.id};d.ajax({url:ajaxurl,data:e,type:"GET",success:function(e){s.html(e);var t=s.find(".li-boxed-editing a");if(t.length){var i=t.attr("data-url"),o=document.createElement("a");o.href=location.href;var n=jQuery.deparam(o.search.substr(1));if(_.isUndefined(n.msid)&&(n.msid=0),_.isNumber(n.msid)||(n.msid=0),n.msid&&n.msid!==OneCoreCustomizer_MS.id){var a=_.clone(window.location),r=_.extend(u.utils.parseQueryString(a.search.substr(1)),{autofocus:{control:"multiple_headers"},url:i});a.search=d.param(r);var c=a.href;window.history.pushState(c,"",c)}}}})})}),d(document).ready(function(r){var e=r(document);e.on("click",".multiple-section-action .button",function(e){e.preventDefault();var t=r(this).closest(".multiple-section-action"),i={title:r(".new-input-name",t).val()||"",builder_id:r(".new-input-name",t).attr("data-builder-id")||"",control_id:r(".new-input-name",t).attr("data-control-id")||"",copy:r(".new-copy",t).is(":checked")?1:""};i.title&&(r(".new-input-name",t).val(""),i.action="tophive/save-section",i.customize_fields=tophive_get_customize_fields(i.control_id),i._nonce=OneCoreCustomizer_MS._nonce,i.current_msid=OneCoreCustomizer_MS.id,r.ajax({url:ajaxurl,data:i,type:"POST",success:function(e){wp.customize.control(i.control_id).container.find(".multiple-section-list").append(e)}}))}),e.on("click",".multiple-section-list .load-tpl",function(e){e.preventDefault();var t=r(this).attr("data-id")||"",i=r(this).attr("data-control-id")||"",o=_.clone(window.location),n=r(this).attr("data-url")||"",a=o.origin+o.pathname+"?autofocus[control]="+i+"&msid="+t;n&&(a+="&url="+encodeURIComponent(n)),top.location.href=a}),e.on("click",".multiple-section-list .remove-tpl",function(e){e.preventDefault();var t=r(this).attr("data-id")||"",i=r(this).attr("data-control-id")||"",o=_.clone(window.location);r(this).closest("li.li-boxed").remove();var n={msid:t,do_remove:1,action:"tophive/save-section"};n._nonce=OneCoreCustomizer_MS._nonce,r.ajax({url:ajaxurl,data:n,type:"POST",success:function(e){top.location.href=o.origin+o.pathname+"?autofocus[control]="+i}})})})}(jQuery,wp.customize);