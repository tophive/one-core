jQuery(document).ready(function(){var i={setAttachment:function(t){this.attachment=t},addParamsURL:function(t,e){return $.isEmptyObject(e)||(t+=(0<=t.indexOf("?")?"&":"?")+$.param(e)),t},getThumb:function(t){void 0!==t&&(this.attachment=t);var e=(new Date).getTime();return void 0!==this.attachment.sizes&&void 0!==this.attachment.sizes.medium?this.addParamsURL(this.attachment.sizes.medium.url,{t:e}):this.addParamsURL(this.attachment.url,{t:e})},getURL:function(t){void 0!==t&&(this.attachment=t);var e=(new Date).getTime();return this.addParamsURL(this.attachment.url,{t:e})},getID:function(t){return void 0!==t&&(this.attachment=t),this.attachment.id},getInputID:function(t){$(".attachment-id",this.preview).val()},setPreview:function(t){this.preview=t},insertImage:function(t){void 0!==t&&(this.attachment=t);var e=this.getURL(),i=this.getID(),a=this.attachment.mime;$(".tophive-image-preview",this.preview).addClass("tophive--has-file").html('<img src="'+e+'" alt="">'),$(".attachment-url",this.preview).val(this.toRelativeUrl(e)),$(".attachment-mime",this.preview).val(a),$(".attachment-id",this.preview).val(i).trigger("change"),this.preview.addClass("attachment-added"),this.showChangeBtn()},toRelativeUrl:function(t){return t},showChangeBtn:function(){$(".tophive--add",this.preview).addClass("tophive--hide"),$(".tophive--change",this.preview).removeClass("tophive--hide"),$(".tophive--remove",this.preview).removeClass("tophive--hide")},insertVideo:function(t){void 0!==t&&(this.attachment=t);var e=this.getURL(),i=this.getID(),a=this.attachment.mime,s='<video width="100%" height="" controls><source src="'+e+'" type="'+a+'">Your browser does not support the video tag.</video>';$(".tophive-image-preview",this.preview).addClass("tophive--has-file").html(s),$(".attachment-url",this.preview).val(this.toRelativeUrl(e)),$(".attachment-mime",this.preview).val(a),$(".attachment-id",this.preview).val(i).trigger("change"),this.preview.addClass("attachment-added"),this.showChangeBtn()},insertFile:function(t){void 0!==t&&(this.attachment=t);var e=t.url,i=this.attachment.mime,a=e.replace(/^.*[\\\/]/,"");$(".tophive-image-preview",this.preview).addClass("tophive--has-file").html('<a href="'+e+'" class="attachment-file" target="_blank">'+a+"</a>"),$(".attachment-url",this.preview).val(this.toRelativeUrl(e)),$(".attachment-mime",this.preview).val(i),$(".attachment-id",this.preview).val(this.getID()).trigger("change"),this.preview.addClass("attachment-added"),this.showChangeBtn()},remove:function(t){void 0!==t&&(this.preview=t),$(".tophive-image-preview",this.preview).removeAttr("style").html("").removeClass("tophive--has-file"),$(".attachment-url",this.preview).val(""),$(".attachment-mime",this.preview).val(""),$(".attachment-id",this.preview).val("").trigger("change"),this.preview.removeClass("attachment-added"),$(".tophive--add",this.preview).removeClass("tophive--hide"),$(".tophive--change",this.preview).addClass("tophive--hide"),$(".tophive--remove",this.preview).addClass("tophive--hide")}};i.controlMediaImage=wp.media({title:wp.media.view.l10n.addMedia,multiple:!1,library:{type:"image"}}),i.controlMediaImage.on("select",function(){var t=i.controlMediaImage.state().get("selection").first().toJSON();i.insertImage(t)}),i.controlMediaVideo=wp.media({title:wp.media.view.l10n.addMedia,multiple:!1,library:{type:"video"}}),i.controlMediaVideo.on("select",function(){var t=i.controlMediaVideo.state().get("selection").first().toJSON();i.insertVideo(t)}),i.controlMediaFile=wp.media({title:wp.media.view.l10n.addMedia,multiple:!1}),i.controlMediaFile.on("select",function(){var t=i.controlMediaFile.state().get("selection").first().toJSON();i.insertFile(t)}),$(".tophive-mt-media").on("click",".tophive--add",function(t){t.preventDefault();var e=$(this).closest(".tophive-mt-media");console.log(e),i.setPreview(e),i.controlMediaImage.open()}),$(".tophive-mt-media").on("click",".tophive--remove",function(t){t.preventDefault();var e=$(this).closest(".tophive-mt-media");i.remove(e)})});